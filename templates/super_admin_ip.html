{% extends "base.html" %}

{% block title %}{{ lang('admin_ip_control') }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
<div>
<h1 class="h2">{{ lang('admin_ip_control') }}</h1>
<p class="text-muted mb-0">
            {{ lang('admin_ip_desc') }}
        </p>
</div>
<div class="btn-toolbar mb-2 mb-md-0">

<button class="btn btn-sm btn-outline-secondary ms-2" onclick="history.back()"><i class="bi bi-arrow-left"></i> {{ lang('btn_back', 'Geri') }}</button></div>
</div>
<div class="row g-4 mb-4">
<div class="col-md-4">
<div class="card border-0 shadow-sm">
<div class="card-body">
<h5 class="card-title mb-3">{{ lang('summary') }}</h5>
<ul class="list-unstyled mb-0">
<li class="mb-2">
<span class="badge bg-success me-2">{{ stats.whitelist_count }}</span>
                        {{ lang('whitelist_records') }}
                    </li>
<li class="mb-2">
<span class="badge bg-danger me-2">{{ stats.blacklist_count }}</span>
                        {{ lang('blacklist_records') }}
                    </li>
<li>
<span class="badge bg-warning text-dark me-2">{{ stats.auto_blocked }}</span>
                        {{ lang('auto_blocked_count') }}
                    </li>
</ul>
</div>
</div>
</div>
</div>
<div class="row g-4">
<div class="col-lg-6">
<div class="card border-0 shadow-sm mb-4">
<div class="card-header">
<h5 class="mb-0">{{ lang('whitelist_add') }}</h5>
</div>
<div class="card-body">
<form method="post">
<input name="action" type="hidden" value="add_whitelist"/>
<div class="mb-3">
<label class="form-label">{{ lang('ip_address') }}</label>
<input class="form-control" name="ip_address" placeholder="192.168.1.10" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">{{ lang('description') }}</label>
<input class="form-control" name="description" placeholder="Ofis ağı, VPN vb." type="text"/>
</div>
<button class="btn btn-success" type="submit">
<i class="bi bi-plus-circle"></i> {{ lang('btn_add_whitelist') }}
                    </button>
</form>
</div>
</div>
<div class="card border-0 shadow-sm">
<div class="card-header d-flex justify-content-between align-items-center">
<h5 class="mb-0">{{ lang('whitelist_records_title') }}</h5>
<span class="badge bg-secondary">{{ whitelist|length }} {{ lang('record') }}</span>
</div>
<div class="card-body p-0">
<div class="table-responsive">
<table class="table table-striped table-hover mb-0">
<thead class="table-light">
<tr>
<th>ID</th>
<th>{{ lang('ip_address') }}</th>
<th>{{ lang('description') }}</th>
<th>{{ lang('added_by') }}</th>
<th>{{ lang('table_date') }}</th>
<th></th>
</tr>
</thead>
<tbody>
                            {% for item in whitelist %}
                            <tr>
<td>{{ item.id }}</td>
<td>{{ item.ip }}</td>
<td>{{ item.description }}</td>
<td>{{ item.added_by }}</td>
<td>{{ item.created_at }}</td>
<td class="text-end">
<form class="d-inline" method="post">
<input name="action" type="hidden" value="remove_whitelist"/>
<input name="ip_address" type="hidden" value="{{ item.ip }}"/>
<button class="btn btn-sm btn-outline-danger" onclick="return confirm('{{ lang('confirm_remove_whitelist') }}');" type="submit">
<i class="bi bi-trash"></i>
</button>
</form>
</td>
</tr>
                            {% else %}
                            <tr>
<td class="text-center py-3 text-muted" colspan="6">Kayıt bulunamadı.</td>
</tr>
                            {% endfor %}
                        </tbody>
</table>
</div>
</div>
</div>
</div>
<div class="col-lg-6">
<div class="card border-0 shadow-sm mb-4">
<div class="card-header">
<h5 class="mb-0">Blacklist Ekle</h5>
</div>
<div class="card-body">
<form method="post">
<input name="action" type="hidden" value="add_blacklist"/>
<div class="mb-3">
<label class="form-label">IP Adresi</label>
<input class="form-control" name="ip_address" placeholder="192.168.1.10" type="text"/>
</div>
<div class="mb-3">
<label class="form-label">Sebep</label>
<select class="form-select" name="reason">
<option value="manual">Manuel</option>
<option value="brute_force">Brute Force</option>
<option value="suspicious">Şüpheli</option>
</select>
</div>
<div class="mb-3">
<label class="form-label">Süre</label>
<select class="form-select" name="duration">
<option value="15">15 dk</option>
<option value="60">1 saat</option>
<option value="1440">1 gün</option>
<option value="permanent">Kalıcı</option>
</select>
</div>
<button class="btn btn-danger" type="submit">
<i class="bi bi-slash-circle"></i> Blacklist'e Ekle
                    </button>
</form>
</div>
</div>
<div class="card border-0 shadow-sm">
<div class="card-header d-flex justify-content-between align-items-center">
<h5 class="mb-0">Blacklist Kayıtları</h5>
<span class="badge bg-secondary">{{ blacklist|length }} kayıt</span>
</div>
<div class="card-body p-0">
<div class="table-responsive">
<table class="table table-striped table-hover mb-0">
<thead class="table-light">
<tr>
<th>ID</th>
<th>IP</th>
<th>Sebep</th>
<th>Bloklayan</th>
<th>Başlangıç</th>
<th>Bitiş</th>
<th>Durum</th>
<th></th>
</tr>
</thead>
<tbody>
                            {% for item in blacklist %}
                            <tr>
<td>{{ item.id }}</td>
<td>{{ item.ip }}</td>
<td>{{ item.reason }}</td>
<td>{{ item.blocked_by }}</td>
<td>{{ item.created_at }}</td>
<td>{{ item.expires_at }}</td>
<td>
                                    {% if item.status == 'Active' %}
                                    <span class="badge bg-success">Aktif</span>
                                    {% elif item.status == 'Expired' %}
                                    <span class="badge bg-secondary">Süresi Dolmuş</span>
                                    {% else %}
                                    <span class="badge bg-warning text-dark">Yakında Dolacak</span>
                                    {% endif %}
                                </td>
<td class="text-end">
<form class="d-inline" method="post">
<input name="action" type="hidden" value="remove_blacklist"/>
<input name="ip_address" type="hidden" value="{{ item.ip }}"/>
<button class="btn btn-sm btn-outline-success" onclick="return confirm('Bu IP blacklist listesinden kaldırılsın mı?');" type="submit">
<i class="bi bi-check2-circle"></i>
</button>
</form>
</td>
</tr>
                            {% else %}
                            <tr>
<td class="text-center py-3 text-muted" colspan="8">Kayıt bulunamadı.</td>
</tr>
                            {% endfor %}
                        </tbody>
</table>
</div>
</div>
</div>
</div>
</div>

{% endblock %}


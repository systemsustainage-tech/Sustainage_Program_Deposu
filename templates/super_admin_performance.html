{% extends "base.html" %}

{% block title %}Performans Dashboard{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
<div>
<h1 class="h2">Performans Dashboard</h1>
<p class="text-muted mb-0">
            Veritabanı büyüklüğü, tablo kayıtları ve performans ayarları.
        </p>
</div>
<div class="btn-toolbar mb-2 mb-md-0">

<button class="btn btn-sm btn-outline-secondary ms-2" onclick="history.back()"><i class="bi bi-arrow-left"></i> {{ _('btn_back', 'Geri') }}</button></div>
</div>
<div class="row g-4 mb-4">
<div class="col-md-3">
<div class="card border-0 shadow-sm">
<div class="card-body">
<h6 class="text-muted text-uppercase">Veritabanı Boyutu</h6>
<h2 class="fw-bold mb-0">{{ metrics.db_size_mb }} MB</h2>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-0 shadow-sm">
<div class="card-body">
<h6 class="text-muted text-uppercase">Tablo Sayısı</h6>
<h2 class="fw-bold mb-0">{{ metrics.table_count }}</h2>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-0 shadow-sm">
<div class="card-body">
<h6 class="text-muted text-uppercase">Index Sayısı</h6>
<h2 class="fw-bold mb-0">{{ metrics.index_count }}</h2>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-0 shadow-sm">
<div class="card-body">
<h6 class="text-muted text-uppercase">Toplam Kayıt</h6>
<h2 class="fw-bold mb-0">{{ metrics.total_records }}</h2>
</div>
</div>
</div>
</div>
<div class="row g-4">
<div class="col-lg-6">
<div class="card border-0 shadow-sm mb-4">
<div class="card-header">
<h5 class="mb-0">Performans Ayarları</h5>
</div>
<div class="card-body">
<form method="post">
<input name="action" type="hidden" value="save_settings"/>
<div class="mb-3">
<label class="form-label">Liste Sayfa Boyutu</label>
<input class="form-control" name="perf_list_page_size" type="text" value="{{ settings.perf_list_page_size }}"/>
<div class="form-text">Kullanıcı, şirket vb. listelerde sayfa başına maksimum kayıt.</div>
</div>
<div class="mb-3">
<label class="form-label">Dashboard Limit</label>
<input class="form-control" name="perf_dashboard_limit" type="text" value="{{ settings.perf_dashboard_limit }}"/>
<div class="form-text">Dashboard ve rapor kartlarında çekilecek maksimum kayıt.</div>
</div>
<div class="mb-3">
<label class="form-label d-block mb-1">Basit Cache</label>
<select class="form-select" name="perf_enable_caching">
<option value="" {% if not settings.perf_enable_caching %}selected{% endif %}>Varsayılan</option>
<option value="1" {% if settings.perf_enable_caching == '1' %}selected{% endif %}>Aktif</option>
<option value="0" {% if settings.perf_enable_caching == '0' %}selected{% endif %}>Pasif</option>
</select>
<div class="form-text">Desteklendiği yerlerde basit cache kullanımını aç/kapat.</div>
</div>
<button class="btn btn-success" type="submit">
<i class="bi bi-save"></i> Ayarları Kaydet
                    </button>
</form>
</div>
</div>
</div>
<div class="col-lg-6">
<div class="card border-0 shadow-sm">
<div class="card-header">
<h5 class="mb-0">En Büyük Tablolar</h5>
</div>
<div class="card-body p-0">
<div class="table-responsive">
<table class="table table-striped table-hover mb-0">
<thead class="table-light">
<tr>
<th>Tablo</th>
<th>Kayıt</th>
</tr>
</thead>
<tbody>
                            {% for t in metrics.table_stats %}
                            <tr>
<td>{{ t.name }}</td>
<td>{{ t.rows }}</td>
</tr>
                            {% else %}
                            <tr>
<td class="text-center py-3 text-muted" colspan="2">Tablo bilgisi alınamadı.</td>
</tr>
                            {% endfor %}
                        </tbody>
</table>
</div>
</div>
</div>
</div>
</div>

{% endblock %}

